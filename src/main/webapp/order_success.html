<!--
Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE HTML>
<html>
<head>
    <title>Spicemystery a Hotel and Resturant Category Flat Bootstarp Responsive Website Template | Checkout ::
        w3layouts</title>
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all">
    <link href="css/style.css" rel="stylesheet" type="text/css" media="all"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="keywords" content="Spicemystery Responsive web template, Bootstrap Web Templates, Flat Web Templates, Andriod Compatible web template,
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyErricsson, Motorola web design"/>
    <script type="application/x-javascript"> addEventListener("load", function () {
        setTimeout(hideURLbar, 0);
    }, false);

    function hideURLbar() {
        window.scrollTo(0, 1);
    } </script>
   <!-- <link href='http://fonts.adminun/css?family=Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='http://fonts.adminun/css?family=Libre+Baskerville:400,700' rel='stylesheet' type='text/css'>-->
    <script src="js/jquery.min.js"></script>

    <link rel="stylesheet" type="text/css" href="css/xcConfirm.css"/>
    <link rel="stylesheet" href="css/common.css">
    <script src="js/jquery-1.9.1.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/xcConfirm.js" type="text/javascript" charset="utf-8"></script>
    <style type="text/css">
        .sgBtn {
            width: 135px;
            height: 35px;
            line-height: 35px;
            margin-left: 10px;
            margin-top: 10px;
            text-align: center;
            background-color: #0095D9;
            color: #FFFFFF;
            float: left;
            border-radius: 5px;
        }
    </style>
</head>
<body>
<!-- header -->
<div class="header-item"></div>
<script>
    $(document).load($('.header-item').load('header.html'));
</script>
<!--
<!-- header -->
<div class="cart-items">
    <div id="checked_items" class="container">
        <h1>My order List</h1>
        <script>$(document).ready(function (c) {
            $('.close1').on('click', function (c) {
                $('.cart-header').fadeOut('slow', function (c) {
                    $('.cart-header').remove();
                });
            });
        });
        </script>
        <!--TODO::订单列表-->
        <div class="order-list ">
            <div class="order-hd">
                <span><i>订单编号：D-03788798</i></span><i>创建时间：2015-05-03 09:26:52</i>
            </div>
            <div class="order-bd clearfix">
                <div class="fl restaurant-msg">
                    <div>
                        <img src="http://dhcrestaurantlogo.dhero.cn/1019?v=1402245333" alt="" width="43" height="43"
                             class="fl">
                        <i class="fl">吉祥馄饨 (高安路店)</i>
                    </div>
                    <p class="clearfix">
                        <i class="fl"></i>
                        <span class="fl">餐厅电话：021-64738871, 18019138185</span>
                    </p>
                </div>
                <div class="fl order-type padding-margin">
                    <p>订单类型：餐到付款</p>
                    <p>订单状态：等待确认</p>
                </div>
                <div class="fl order-total padding-margin">
                    <p>订单金额</p>
                    <p><i>￥32.00</i></p>
                </div>
                <div class="order-operate fl padding-margin">
                    <!--TODO:: 查看详情需要能附加一段 HTML 在当前的 div 内-->
                    <p>
                        <a href="javascript:" order-number="" orderid="3788798"
                           class="btn_a see-details">查看详情<i></i></a>
                    </p>
                </div>
            </div>
            <div class="order-details clearfix">
                <div ng-hide="orderStatus['3788798']" class="order-loading">
                    <span ng-show="orderStatus['3788798_error']" class="order-hide ng-hide">访问出错，请重新加载！</span>
                </div>
                <div ng-show="orderStatus['3788798']" class="ng-hide">
                    <div class="order-menu-info fl">
                        <div class="order-menu-inner">
                            <div class="cart-thead clearfix">
                                <div class="goods-name">商品</div>
                                <div class="goods-count">份数</div>
                                <div class="goods-price">单价</div>
                                <div class="goods-subtotal">小计</div>
                            </div>
                            <div class="cart-body">
                                <!-- ngRepeat: menu_item in order['3788798'].menu_items_data -->
                                <!-- ngRepeat: add_item in order['3788798'].total_additions -->
                            </div>
                            <div class="cart-footer clearfix">
                                <div class="order-adress fl">
                                    <!-- ngIf: order['3788798'].preorder_time -->
                                    <div><label for="">送餐电话：</label><span ng-bind="order['3788798'].customer_phone"
                                                                          class="ng-binding"></span></div>
                                    <div class="clearfix">
                                        <label for="" class="fl">送餐地址：</label>
                                        <p class="fl ng-binding" ng-bind="order['3788798'].address_text"></p>
                                    </div>
                                    <!-- ngIf: order['3788798'].comment -->
                                </div>
                                <div class="total fr">
                                    <p>配送费：<span ng-bind="order['3788798'].delivery_fee|currency:'￥'"
                                                 class="ng-binding"></span></p>
                                    <p>优惠券：<span ng-bind="order['3788798'].coupon_amount|currency:'￥'"
                                                 class="ng-binding"></span></p>
                                    <p class="order-total">实付金额：<span
                                            ng-bind="order['3788798'].order_total|currency:'￥'"
                                            class="ng-binding"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <ul class="order-logistics fl">
                        <!-- ngRepeat: workflow in order['3788798'].status_workflow -->
                    </ul>
                </div>
            </div>
        </div>
        <div class="order-list ">
            <div class="order-hd">
                <span><i>订单编号：D-03788798</i></span><i>创建时间：2015-05-03 09:26:52</i>
            </div>
            <div class="order-bd clearfix">
                <div class="fl restaurant-msg">
                    <div>
                        <img src="http://dhcrestaurantlogo.dhero.cn/1019?v=1402245333" alt="" width="43" height="43"
                             class="fl">
                        <i class="fl">吉祥馄饨 (高安路店)</i>
                    </div>
                    <p class="clearfix">
                        <i class="fl"></i>
                        <span class="fl">餐厅电话：021-64738871, 18019138185</span>
                    </p>
                </div>
                <div class="fl order-type padding-margin">
                    <p>订单类型：餐到付款</p>
                    <p>订单状态：等待确认</p>
                </div>
                <div class="fl order-total padding-margin">
                    <p>订单金额</p>
                    <p><i>￥32.00</i></p>
                </div>
                <div class="order-operate fl padding-margin">
                    <!--TODO:: 查看详情需要能附加一段 HTML 在当前的 div 内-->
                    <p>
                        <a href="javascript:void(0);" order-number="" orderid="3788798"
                           class="btn_a see-details">查看详情<i></i></a>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- 遮罩层 -->
    <div id="cover"
         style="background: #000; position: absolute; left: 0px; top: 0px; width: 100%; filter: alpha(opacity=30); opacity: 0.3; display: none; z-index: 2 ">

    </div>
    <!-- checkout -->
    <!-- footer-->
    <div class="footer">
        <div class="container">
            <div class="footer-left">
                <p>Copyrights © 2015 SpiceMystery All rights reserved | Design by <a
                        href="http://w3layouts.com/">W3layouts</a></p>
            </div>
            <div class="footer-right">
                <ul>
                    <li><a href="#"><i class="fbk"></i></a></li>
                    <li><a href="#"><i class="googpl"></i></a></li>
                    <li><a href="#"><i class="link"></i></a></li>
                    <li><a href="#"><i class="rss"></i></a></li>
                    <li><a href="#"><i class="twt"></i></a></li>
                </ul>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
</div>
    <!-- footer-->
    <script>

        var order_items = new Array();
        $(document).ready(function () {
            $.getJSON("order/user-order-list.json",
                function (res) {
                    var order_list = "";
                    if(res.status != 200){
                        alert(res.msg);
                        return ;
                    }
                    var data = res.data;
                    $.each(data, function (i, order) {
                        order_list += set_one_order(i,order);
                        order_items[i] = order.items;
                    });
                    $("#checked_items").html(order_list);
                }
            );
        });

        function show_order_detail(index) {
            disable_a(index);
            //根据 items的大小来扩大 DIV 的高度
            var items = order_items[index];
            //扩大 div 的高度
            var order_listId = '#order_list_'+ index;
            var order_title = set_order_title();
            var details = "";
            $.each(items, function (i, item) {
                details += set_item_detail(item);
            });
            //将订单详情写入里面
            var id= "#order_bd_"+ index;
            console.log(items.length);
            $(order_listId).height(160 + 60 * items.length);
            //$(id).after(" <h1>My order Detail</h1>");
           $(id).after(order_title + details);

        }


        function set_one_order(index,order){
            var oneOrder =
                "<div class=\"order-list\" "+" id=order_list_"+index+">" +
                "    <div class=\"order-hd\">" +
                "        <span><i>订单编号：" + order.orderNo + "</i></span><i>创建时间：" + order.createTime + "</i>" +
                "    </div>" +
                "    <div class=\"order-bd clearfix\"  id=\""+"order_bd_"+index+"\">" +
                "        <div class=\"fl restaurant-msg\">" +
                "            <div>" +
                "                <img src=\"http://dhcrestaurantlogo.dhero.cn/1019?v=1402245333\" alt=\"\" width=\"43\" height=\"43\"" +
                "                     class=\"fl\">" +
                "                <i class=\"fl\">" + order.shopName + "</i>" +
                "            </div>" +
                "            <p class=\"clearfix\">" +
                "                <i class=\"fl\"></i>" +
                "                <span class=\"fl\">餐厅电话：" + order.shopPhone + "</span>" +
                "            </p>" +
                "        </div>" +
                "        <div class=\"fl order-type padding-margin\">" +
                "            <p>订单类型：餐到付款</p>" +
                "            <p>订单状态：等待确认</p>" +
                "        </div>" +
                "        <div class=\"fl order-total padding-margin\">" +
                "            <p>订单金额</p>" +
                "            <p><i>￥" + order.totalPrice + "</i></p>" +
                "        </div>" +
                "        <div class=\"order-operate fl padding-margin\">" +
                "            <!--TODO:: 查看详情需要能附加一段 HTML 在当前的 div 内-->" +
                "            <p>" +
                "                <a href=\"javascript:void(0);\""+
                "                   class=\"btn_a see-details\"  id=\"see_detail"+index+"\"  onclick=\"show_order_detail("+index+")\">查看详情<i></i></a>" +
                "            </p>" +
                "        </div>" +
                "    </div>" +
                "</div>";
            return oneOrder;
        }


        function set_order_title() {

            var order_title =
                "<div class=\"cart-title clearfix\">" +
                "<div class=\"goods-name fl goods-font\">商品</div>" +
                "<div class=\"goods-count fl goods-font\">份数</div>" +
                "<div class=\"goods-price fl goods-font\">单价</div>" +
                "<div class=\"goods-subtotal fl goods-font\">小计</div>" +
                "</div>";
            return order_title;
        }

        /**
         * 将 A 标签置为不可选的状态
         * @param index
         */
        function disable_a(index) {
            var a_id = "#see_detail" + index;
            $(a_id).attr("disabled",true);
            $(a_id).css("pointer-events","none");
        }

        /**
         * 设置订单中商品的内容
         * @param item
         */
        function set_item_detail(item) {
            var total = item.price * item.cnt;
            var detail =  "<div class=\"cart-detail clearfix\">" +
                "<div class=\"goods-name fl goods-font2\">"+item.itemName+"</div>" +
                "<div class=\"goods-count fl goods-font2\">"+item.cnt+"</div>" +
                "<div class=\"goods-price fl goods-font2\">￥："+item.price+"</div>" +
                "<div class=\"goods-subtotal fl goods-font2\">￥："+total+"</div>" +
                "</div>";
            return detail;
        }
    </script>
</body>
</html>